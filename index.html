<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Super Sete - Gerador de Palpites Avan√ßado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        supersete: '#A9CF46',
                        'supersete-light': '#bdd75e',
                        'supersete-dark': '#8fb83a',
                        'supersete-bg': '#f8fcf0'
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .loading-circle {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, #A9CF46, #bdd75e, #8fb83a);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .numero-super {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #A9CF46, #bdd75e);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
            margin: 2px;
        }
        
        .numero-super:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(169, 207, 70, 0.4);
        }
        
        .numero-super.selecionado {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
        }
        
        .numero-super.disabled {
            background: #9ca3af;
            cursor: not-allowed;
            opacity: 0.5;
        }

        .numero-super.sorteado {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
            border: 2px solid #fbbf24;
            position: relative;
        }

        .numero-super.sorteado::after {
            content: "üéØ";
            position: absolute;
            top: -6px;
            right: -6px;
            font-size: 10px;
            background: #fbbf24;
            color: #333;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .numero-super.sorteado.disabled {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            opacity: 0.4;
            cursor: not-allowed;
        }

        .numero-super.sorteado.disabled::after {
            background: #9ca3af;
        }
        
        .coluna-super {
            background: linear-gradient(to bottom, #f8fcf0, #f0f9e8);
            border: 2px solid #A9CF46;
            border-radius: 12px;
            padding: 12px;
            text-align: center;
        }
        
        .jogo-card {
            background: linear-gradient(to right, #f8fcf0, #f0f9e8);
            border: 2px solid #A9CF46;
            border-radius: 12px;
            padding: 16px;
            margin: 8px 0;
        }
        
        .numero-jogo {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, #A9CF46, #bdd75e);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
        
        .custo-total {
            background: linear-gradient(45deg, #A9CF46, #8fb83a);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 18px;
        }

        .digito-badge {
            background: linear-gradient(45deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
        }

        .numero-resultado {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #A9CF46, #bdd75e);
            color: white;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            margin: 0 4px;
        }

        .coluna-titulo {
            background: linear-gradient(135deg, #A9CF46, #8fb83a);
            color: white;
            padding: 8px;
            border-radius: 8px 8px 0 0;
            font-weight: bold;
            font-size: 14px;
        }
    </style>
</head>
<body class="bg-supersete-bg min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-4xl font-bold text-supersete mb-2">üéØ SUPER SETE</h1>
            <p class="text-gray-600">Gerador de Palpites com An√°lise Estat√≠stica</p>
        </div>

        <!-- Loading -->
        <div id="loading" class="text-center py-8">
            <div class="loading-circle mx-auto mb-4"></div>
            <p class="text-supersete font-medium">Carregando √∫ltimo resultado...</p>
        </div>

        <!-- √öltimo Resultado -->
        <div id="ultimoResultado" class="hidden mb-6">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden border-2 border-supersete">
                <div class="bg-supersete text-white p-4 text-center">
                    <h2 id="tituloResultado" class="text-xl font-bold">Concurso 732</h2>
                    <div id="dataResultado" class="text-sm">üìÖ 13/08/2025 (Quarta)</div>
                </div>
                
                <div class="p-6 text-center">
                    <div class="mb-4">
                        <h3 class="text-lg font-bold text-supersete mb-3">N√∫meros Sorteados</h3>
                        <div id="numerosResultado" class="flex justify-center gap-2 mb-4">
                            <!-- N√∫meros sorteados ser√£o inseridos aqui -->
                        </div>
                    </div>
                    
                    <div id="statusResultado" class="text-lg font-bold mb-4 text-red-600">
                        ACUMULOU!
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div id="premiacao6" class="flex items-center justify-center">
                            <span class="text-supersete mr-2">üèÜ</span>
                            <span>6 acertos: 3 apostas ganhadoras - R$ 17.736,07</span>
                        </div>
                        <div id="premiacao5" class="flex items-center justify-center">
                            <span class="text-supersete mr-2">üèÜ</span>
                            <span>5 acertos: 61 apostas ganhadoras - R$ 598,41</span>
                        </div>
                    </div>
                    
                    <div class="mt-4 text-center">
                        <div class="text-sm text-gray-600">Pr√≥ximo Sorteio: Concurso 733</div>
                        <div class="text-sm text-gray-600">15/08/2025 (Sexta)</div>
                        <div class="text-2xl font-bold text-supersete mt-2">
                            Pr√™mio Estimado: R$ 5.300.000,00
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interface Principal - Dividida em 2 Colunas -->
        <div id="interfacePrincipal" class="hidden grid grid-cols-1 xl:grid-cols-2 gap-6">
            
            <!-- LADO ESQUERDO: Cria√ß√£o de Jogos -->
            <div class="space-y-6">
                <!-- Controles do Jogo -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-supersete">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-supersete">üéÆ Criar Novo Jogo</h3>
                        <button id="comoFuncionaBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-sm">
                            ‚ùì Como Funciona
                        </button>
                    </div>
                    
                    <!-- Informa√ß√£o do Jogo -->
                    <div class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                        <div class="text-sm font-medium text-green-800 mb-2">‚ÑπÔ∏è Como Jogar:</div>
                        <div class="text-xs text-green-700">
                            Selecione <strong>1 n√∫mero</strong> em cada uma das <strong>7 colunas</strong> abaixo.
                            Cada coluna tem n√∫meros de 0 a 9.
                        </div>
                    </div>

                    <!-- Controle de N√∫meros Sorteados -->
                    <div id="controleNumerosSorteados" class="mb-4 p-3 bg-orange-50 border border-orange-200 rounded-lg hidden">
                        <div class="flex justify-between items-center mb-2">
                            <div class="text-sm font-medium text-orange-800">
                                üéØ N√∫meros j√° sorteados por coluna: <span id="numerosSorteadosLista" class="font-bold"></span>
                            </div>
                            <label class="flex items-center text-sm">
                                <input type="checkbox" id="permitirNumerosSorteados" class="mr-2">
                                <span class="text-orange-700">Permitir usar n√∫meros j√° sorteados</span>
                            </label>
                        </div>
                        <div class="text-xs text-orange-600">
                            Por padr√£o, n√∫meros que sa√≠ram no √∫ltimo concurso est√£o <strong>desabilitados</strong> em suas respectivas colunas.
                        </div>
                    </div>

                    <!-- An√°lise do Jogo Atual -->
                    <div id="analiseJogo" class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                        <div class="text-sm font-medium text-blue-800 mb-2">üìä Status do Jogo:</div>
                        <div class="grid grid-cols-2 gap-2 text-xs">
                            <div>Colunas preenchidas: <span id="colunasCount" class="font-bold">0/7</span></div>
                            <div>D√≠gitos √∫nicos: <span id="digitosUnicos" class="font-bold">0</span></div>
                        </div>
                        <div id="statusValidacao" class="mt-2 text-xs">
                            <!-- Status da valida√ß√£o -->
                        </div>
                    </div>

                    <!-- Grid das 7 Colunas -->
                    <div class="mb-4">
                        <label class="block text-supersete font-medium mb-3">Selecione os N√∫meros (1 por coluna):</label>
                        <div class="grid grid-cols-7 gap-2" id="gridColunas">
                            <!-- Colunas ser√£o geradas aqui -->
                        </div>
                    </div>

                    <!-- Bot√µes de A√ß√£o -->
                    <div class="flex flex-wrap gap-2">
                        <button id="limparJogo" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">
                            üóëÔ∏è Limpar
                        </button>
                        <button id="randomizarJogo" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg">
                            üé≤ Aleat√≥rio
                        </button>
                        <button id="adicionarJogo" class="bg-supersete hover:bg-supersete-dark text-white px-4 py-2 rounded-lg disabled:opacity-50">
                            ‚ûï Adicionar Jogo
                        </button>
                    </div>
                </div>

                <!-- Tabela de Probabilidades -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-blue-200">
                    <h3 class="text-lg font-bold text-blue-800 mb-4">üìä Probabilidades de Acerto</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-xs">
                            <thead class="bg-blue-100">
                                <tr>
                                    <th class="p-2 text-left">Acertos</th>
                                    <th class="p-2 text-right">Probabilidade</th>
                                    <th class="p-2 text-right">1 em X</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td class="p-1">7 acertos</td><td class="p-1 text-right">0,00001%</td><td class="p-1 text-right">10.000.000</td></tr>
                                <tr class="bg-gray-50"><td class="p-1">6 acertos</td><td class="p-1 text-right">0,00007%</td><td class="p-1 text-right">1.428.571</td></tr>
                                <tr><td class="p-1">5 acertos</td><td class="p-1 text-right">0,00063%</td><td class="p-1 text-right">158.730</td></tr>
                                <tr class="bg-gray-50"><td class="p-1">4 acertos</td><td class="p-1 text-right">0,0063%</td><td class="p-1 text-right">15.873</td></tr>
                                <tr><td class="p-1">3 acertos</td><td class="p-1 text-right">0,063%</td><td class="p-1 text-right">1.587</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-3 text-xs text-blue-600">
                        üí° <strong>Super Sete:</strong> Jogo b√°sico custa R$ 2,50
                    </div>
                </div>
            </div>

            <!-- LADO DIREITO: Visualiza√ß√£o dos Jogos -->
            <div class="space-y-6">
                <!-- Resumo e Controles -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-supersete">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-supersete">üìã Meus Jogos</h3>
                        <div class="flex items-center gap-2">
                            <span class="text-sm text-gray-600">Super Sete - R$ 2,50 cada</span>
                        </div>
                    </div>

                    <!-- Custo Total -->
                    <div class="mb-4">
                        <div class="custo-total text-center">
                            üí∞ Total: <span id="custoTotal">R$ 0,00</span>
                        </div>
                        <div class="text-center text-sm text-gray-600 mt-2">
                            <span id="totalJogos">0</span> jogo(s) adicionado(s)
                        </div>
                    </div>

                    <!-- Bot√µes de Download -->
                    <div class="grid grid-cols-3 gap-2 mb-4">
                        <button id="downloadHTML" class="bg-orange-500 hover:bg-orange-600 text-white px-3 py-2 rounded-lg text-sm">
                            üåê HTML
                        </button>
                        <button id="downloadTXT" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm" title="TXT: Agora minimalista - s√≥ n√∫meros!">
                            üìÑ TXT
                        </button>
                        <button id="downloadXLSX" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-sm">
                            üìä XLSX
                        </button>
                    </div>

                    <!-- Bot√£o Limpar Todos -->
                    <button id="limparTodos" class="w-full bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg">
                        üóëÔ∏è Limpar Todos os Jogos
                    </button>
                </div>

                <!-- Lista dos Jogos -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-gray-200 max-h-96 overflow-y-auto">
                    <h4 class="font-bold text-gray-800 mb-4">Lista de Jogos:</h4>
                    <div id="listaJogos">
                        <p class="text-gray-500 text-center py-8">Nenhum jogo adicionado ainda</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Como Funciona -->
        <div id="modalComoFunciona" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-lg shadow-lg max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
                <div class="bg-supersete text-white p-6 rounded-t-lg">
                    <h2 class="text-2xl font-bold text-center">üéØ Como Funciona o Super Sete</h2>
                </div>
                
                <div class="p-6 space-y-6">
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-green-800 mb-3">üìã Passo a Passo:</h3>
                        <div class="space-y-3 text-green-700">
                            <p><strong>1. Entenda o jogo:</strong> Super Sete tem 7 colunas independentes</p>
                            <p><strong>2. Selecione os n√∫meros:</strong> Escolha 1 n√∫mero (0-9) em cada uma das 7 colunas</p>
                            <p><strong>3. Valida√ß√£o autom√°tica:</strong> Sistema verifica se todas as colunas est√£o preenchidas</p>
                            <p><strong>4. An√°lise de padr√µes:</strong> Veja quantos d√≠gitos √∫nicos seu jogo tem</p>
                            <p><strong>5. Custo fixo:</strong> Cada jogo custa R$ 2,50</p>
                            <p><strong>6. Download:</strong> Exporte seus jogos em HTML, TXT ou XLSX</p>
                        </div>
                    </div>

                    <!-- Controle de N√∫meros Sorteados -->
                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-orange-800 mb-3">üéØ Controle de N√∫meros Sorteados:</h3>
                        <div class="space-y-2 text-orange-700">
                            <p><strong>Bloqueio por coluna:</strong> N√∫meros do √∫ltimo concurso ficam desabilitados apenas em suas respectivas colunas</p>
                            <p><strong>Visual especial:</strong> N√∫meros sorteados t√™m √≠cone üéØ e cor laranja</p>
                            <p><strong>Estrat√©gia inteligente:</strong> Evita repetir exatamente o mesmo resultado por posi√ß√£o</p>
                            <p><strong>Flexibilidade:</strong> Marque "Permitir n√∫meros sorteados" para habilit√°-los</p>
                            <p><strong>Randomiza√ß√£o inteligente:</strong> Gera√ß√£o aleat√≥ria respeitar√° sua prefer√™ncia automaticamente</p>
                            <p><strong>Exemplo:</strong> Se Col1=3, Col2=2, Col3=5 sa√≠ram, apenas esses n√∫meros ficam bloqueados em suas colunas</p>
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-blue-800 mb-3">üéØ Como Funciona o Super Sete:</h3>
                        <div class="space-y-2 text-blue-700">
                            <p><strong>7 Colunas:</strong> Cada coluna representa uma posi√ß√£o no jogo</p>
                            <p><strong>N√∫meros 0-9:</strong> Cada coluna tem 10 op√ß√µes (0, 1, 2, 3, 4, 5, 6, 7, 8, 9)</p>
                            <p><strong>1 por coluna:</strong> Voc√™ deve escolher exatamente 1 n√∫mero em cada coluna</p>
                            <p><strong>Exemplo:</strong> Coluna 1‚Üí3, Coluna 2‚Üí2, Coluna 3‚Üí5, etc.</p>
                            <p><strong>Resultado:</strong> Para ganhar, seus n√∫meros devem coincidir nas posi√ß√µes corretas</p>
                        </div>
                    </div>

                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <h3 class="text-xl font-bold text-yellow-800 mb-3">üí∞ Sistema de Premia√ß√£o:</h3>
                        <div class="space-y-3">
                            <div class="bg-white p-3 rounded border border-yellow-300">
                                <div class="text-sm font-medium text-yellow-800 mb-2">üèÜ Faixas de Premia√ß√£o:</div>
                                <div class="grid grid-cols-1 gap-2 text-xs text-yellow-700">
                                    <div><strong>7 acertos:</strong> Pr√™mio m√°ximo</div>
                                    <div><strong>6 acertos:</strong> Pr√™mio alto</div>
                                    <div><strong>5 acertos:</strong> Pr√™mio m√©dio</div>
                                    <div><strong>4 acertos:</strong> Pr√™mio baixo</div>
                                    <div><strong>3 acertos:</strong> Pr√™mio m√≠nimo (R$ 5,00)</div>
                                </div>
                            </div>
                            
                            <div class="text-sm">
                                <div><strong>Valor da aposta:</strong> R$ 2,50 (fixo)</div>
                                <div><strong>Desenhos:</strong> Ter√ßa, Quinta e S√°bado</div>
                            </div>
                            
                            <div class="text-xs text-yellow-600">
                                üí° <strong>Dica:</strong> Varie os n√∫meros entre as colunas para aumentar suas chances!
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 px-6 py-4 rounded-b-lg text-center">
                    <button id="fecharModal" class="bg-supersete hover:bg-supersete-dark text-white font-medium py-2 px-6 rounded-lg">
                        ‚úÖ Entendi, Vamos Jogar!
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Vari√°veis globais
        let ultimoResultado = null;
        let jogosAdicionados = [];
        let numerosSelecionados = [null, null, null, null, null, null, null]; // 7 colunas
        let numerosSorteados = []; // Array com 7 posi√ß√µes para n√∫meros sorteados por coluna
        const custoJogo = 2.50; // Super Sete tem custo fixo

        // Inicializa√ß√£o da aplica√ß√£o
        document.addEventListener('DOMContentLoaded', async () => {
            await carregarUltimoResultado();
            inicializarInterface();
            configurarEventListeners();
        });

        // Carregar √∫ltimo resultado do Super Sete
        async function carregarUltimoResultado() {
            try {
                const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/supersete');
                const data = await response.json();
                ultimoResultado = data;
                exibirUltimoResultado(data);
            } catch (error) {
                console.error('Erro ao carregar resultado:', error);
                // Usar dados de exemplo se a API falhar
                const dadosExemplo = {
                    numero: 732,
                    dataApuracao: "13/08/2025",
                    dataProximoConcurso: "15/08/2025",
                    listaDezenas: ["3", "2", "5", "0", "3", "6", "9"],
                    acumulado: true,
                    valorEstimadoProximoConcurso: 5300000.00,
                    listaRateioPremio: [
                        { descricaoFaixa: "6 acertos", numeroDeGanhadores: 3, valorPremio: 17736.07 },
                        { descricaoFaixa: "5 acertos", numeroDeGanhadores: 61, valorPremio: 598.41 }
                    ]
                };
                exibirUltimoResultado(dadosExemplo);
            } finally {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('ultimoResultado').classList.remove('hidden');
                document.getElementById('interfacePrincipal').classList.remove('hidden');
            }
        }

        // Exibir √∫ltimo resultado
        function exibirUltimoResultado(data) {
            document.getElementById('tituloResultado').textContent = `Concurso ${data.numero}`;
            document.getElementById('dataResultado').textContent = `üìÖ ${data.dataApuracao} (Quarta)`;

            // N√∫meros sorteados
            const numerosDiv = document.getElementById('numerosResultado');
            numerosDiv.innerHTML = '';
            const numerosSorteio = data.listaDezenas || data.dezenasSorteadasOrdemSorteio || [];
            
            numerosSorteio.forEach((num, index) => {
                const numeroEl = document.createElement('div');
                numeroEl.className = 'numero-resultado';
                numeroEl.textContent = num;
                numeroEl.title = `Coluna ${index + 1}`;
                numerosDiv.appendChild(numeroEl);
            });

            // Identificar n√∫meros sorteados para bloqueio
            identificarNumerosSorteados(numerosSorteio);

            // Status do concurso
            document.getElementById('statusResultado').textContent = data.acumulado ? 'ACUMULOU!' : 'TEVE GANHADOR!';

            // Pr√≥ximo concurso
            document.querySelector('.text-2xl.font-bold.text-supersete').textContent = 
                `Pr√™mio Estimado: ${formatarMoeda(data.valorEstimadoProximoConcurso || 5300000)}`;
        }

        // Identificar n√∫meros sorteados para bloqueio
        function identificarNumerosSorteados(numeros) {
            numerosSorteados = numeros.map(num => parseInt(num));
            
            // Exibir controle se h√° n√∫meros sorteados
            if (numerosSorteados.length === 7) {
                exibirControleNumerosSorteados();
            }
        }

        // Exibir controle de n√∫meros sorteados
        function exibirControleNumerosSorteados() {
            const controle = document.getElementById('controleNumerosSorteados');
            const lista = document.getElementById('numerosSorteadosLista');
            
            const numerosTexto = numerosSorteados.map((num, index) => `Col${index + 1}=${num}`).join(', ');
            lista.textContent = numerosTexto;
            
            controle.classList.remove('hidden');
        }

        // Inicializar interface
        function inicializarInterface() {
            criarGridColunas();
            atualizarAnaliseJogo();
        }

        // Criar grid das 7 colunas
        function criarGridColunas() {
            const grid = document.getElementById('gridColunas');
            grid.innerHTML = '';
            
            for (let coluna = 0; coluna < 7; coluna++) {
                const colunaDiv = document.createElement('div');
                colunaDiv.className = 'coluna-super';
                
                // T√≠tulo da coluna
                const titulo = document.createElement('div');
                titulo.className = 'coluna-titulo';
                titulo.textContent = `Col ${coluna + 1}`;
                colunaDiv.appendChild(titulo);
                
                // Container dos n√∫meros
                const numerosContainer = document.createElement('div');
                numerosContainer.className = 'grid grid-cols-2 gap-1 mt-2';
                
                // N√∫meros 0-9
                for (let numero = 0; numero <= 9; numero++) {
                    const btn = document.createElement('button');
                    btn.className = 'numero-super';
                    btn.textContent = numero;
                    btn.onclick = () => selecionarNumero(coluna, numero);
                    btn.id = `col-${coluna}-num-${numero}`;
                    
                    // Aplicar classe de n√∫mero sorteado se necess√°rio
                    if (numerosSorteados[coluna] === numero) {
                        btn.classList.add('sorteado');
                    }
                    
                    numerosContainer.appendChild(btn);
                }
                
                colunaDiv.appendChild(numerosContainer);
                grid.appendChild(colunaDiv);
            }
            
            // Atualizar estado inicial
            atualizarEstadoNumerosSorteados();
        }

        // Atualizar estado dos n√∫meros sorteados
        function atualizarEstadoNumerosSorteados() {
            const permitir = document.getElementById('permitirNumerosSorteados').checked;
            
            numerosSorteados.forEach((numeroSorteado, coluna) => {
                const btn = document.getElementById(`col-${coluna}-num-${numeroSorteado}`);
                if (btn) {
                    if (permitir) {
                        // Checkbox MARCADO: HABILITAR n√∫meros sorteados
                        btn.classList.remove('disabled');
                        btn.style.cursor = 'pointer';
                        btn.onclick = () => selecionarNumero(coluna, numeroSorteado);
                    } else {
                        // Checkbox DESMARCADO (padr√£o): DESABILITAR n√∫meros sorteados
                        btn.classList.add('disabled');
                        btn.style.cursor = 'not-allowed';
                        btn.onclick = () => {
                            mostrarModalNumeroSorteado(coluna + 1, numeroSorteado);
                        };
                    }
                }
            });
        }

        // Mostrar modal explicativo para n√∫mero sorteado
        function mostrarModalNumeroSorteado(coluna, numero) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <h3 class="font-bold text-orange-800 mb-2">üéØ N√∫mero Sorteado</h3>
                    <p class="text-gray-700 mb-4">O n√∫mero ${numero} saiu na Coluna ${coluna} do √∫ltimo concurso. Marque "Permitir usar n√∫meros j√° sorteados" para inclu√≠-lo nos seus jogos.</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-orange-500 text-white hover:bg-orange-600 rounded" onclick="this.closest('.fixed').remove()">Entendi</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Selecionar n√∫mero em uma coluna
        function selecionarNumero(coluna, numero) {
            // Verificar se n√∫mero est√° bloqueado
            if (numerosSorteados[coluna] === numero && !document.getElementById('permitirNumerosSorteados').checked) {
                mostrarModalNumeroSorteado(coluna + 1, numero);
                return;
            }

            // Limpar sele√ß√£o anterior da coluna
            if (numerosSelecionados[coluna] !== null) {
                const btnAnterior = document.getElementById(`col-${coluna}-num-${numerosSelecionados[coluna]}`);
                btnAnterior.classList.remove('selecionado');
            }
            
            // Selecionar novo n√∫mero
            const btn = document.getElementById(`col-${coluna}-num-${numero}`);
            btn.classList.add('selecionado');
            numerosSelecionados[coluna] = numero;
            
            atualizarAnaliseJogo();
            validarBotaoAdicionar();
        }

        // Atualizar an√°lise do jogo atual
        function atualizarAnaliseJogo() {
            const colunasPreenchidas = numerosSelecionados.filter(n => n !== null).length;
            document.getElementById('colunasCount').textContent = `${colunasPreenchidas}/7`;
            
            // Calcular d√≠gitos √∫nicos
            const digitosUnicos = new Set(numerosSelecionados.filter(n => n !== null)).size;
            document.getElementById('digitosUnicos').textContent = digitosUnicos;
            
            // Status da valida√ß√£o
            const statusEl = document.getElementById('statusValidacao');
            if (colunasPreenchidas === 0) {
                statusEl.textContent = 'Selecione 1 n√∫mero em cada coluna para formar seu jogo.';
                statusEl.className = 'mt-2 text-xs text-gray-600';
            } else if (colunasPreenchidas === 7) {
                statusEl.textContent = `‚úÖ Jogo completo! ${digitosUnicos} d√≠gitos √∫nicos.`;
                statusEl.className = 'mt-2 text-xs text-green-600';
            } else {
                statusEl.textContent = `Faltam ${7 - colunasPreenchidas} coluna(s) para completar o jogo.`;
                statusEl.className = 'mt-2 text-xs text-orange-600';
            }
        }

        // Validar bot√£o adicionar
        function validarBotaoAdicionar() {
            const btn = document.getElementById('adicionarJogo');
            const completo = numerosSelecionados.every(n => n !== null);
            btn.disabled = !completo;
        }

        // Configurar event listeners
        function configurarEventListeners() {
            // Controle de n√∫meros sorteados
            document.getElementById('permitirNumerosSorteados').addEventListener('change', () => {
                atualizarEstadoNumerosSorteados();
            });

            // Bot√µes de a√ß√£o do jogo
            document.getElementById('limparJogo').addEventListener('click', limparSelecao);
            document.getElementById('randomizarJogo').addEventListener('click', randomizarJogo);
            document.getElementById('adicionarJogo').addEventListener('click', adicionarJogo);
            
            // Controles dos jogos
            document.getElementById('limparTodos').addEventListener('click', limparTodosJogos);
            
            // Downloads
            document.getElementById('downloadHTML').addEventListener('click', () => downloadJogos('html'));
            document.getElementById('downloadTXT').addEventListener('click', () => downloadJogos('txt'));
            document.getElementById('downloadXLSX').addEventListener('click', () => downloadJogos('xlsx'));
            
            // Modal
            document.getElementById('comoFuncionaBtn').addEventListener('click', () => {
                document.getElementById('modalComoFunciona').classList.remove('hidden');
            });
            document.getElementById('fecharModal').addEventListener('click', () => {
                document.getElementById('modalComoFunciona').classList.add('hidden');
            });
        }

        // Limpar sele√ß√£o atual
        function limparSelecao() {
            numerosSelecionados = [null, null, null, null, null, null, null];
            document.querySelectorAll('.numero-super').forEach(btn => {
                btn.classList.remove('selecionado');
            });
            atualizarAnaliseJogo();
            validarBotaoAdicionar();
        }

        // Randomizar jogo respeitando n√∫meros sorteados
        function randomizarJogo() {
            limparSelecao();
            
            const permiteSorteados = document.getElementById('permitirNumerosSorteados').checked;
            
            for (let coluna = 0; coluna < 7; coluna++) {
                let numerosDisponiveis = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
                
                // Se n√£o permite sorteados, remover o n√∫mero sorteado desta coluna
                if (!permiteSorteados && numerosSorteados[coluna] !== undefined) {
                    numerosDisponiveis = numerosDisponiveis.filter(num => num !== numerosSorteados[coluna]);
                }
                
                if (numerosDisponiveis.length > 0) {
                    const numeroAleatorio = numerosDisponiveis[Math.floor(Math.random() * numerosDisponiveis.length)];
                    selecionarNumero(coluna, numeroAleatorio);
                }
            }
        }

        // Adicionar jogo √† lista
        function adicionarJogo() {
            if (!numerosSelecionados.every(n => n !== null)) return;
            
            const jogo = {
                id: Date.now(),
                numeros: [...numerosSelecionados],
                custo: custoJogo,
                digitosUnicos: new Set(numerosSelecionados).size
            };
            
            jogosAdicionados.push(jogo);
            limparSelecao();
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
        }

        // Atualizar visualiza√ß√£o dos jogos
        function atualizarVisualizacaoJogos() {
            const lista = document.getElementById('listaJogos');
            
            if (jogosAdicionados.length === 0) {
                lista.innerHTML = '<p class="text-gray-500 text-center py-8">Nenhum jogo adicionado ainda</p>';
                return;
            }
            
            lista.innerHTML = '';
            jogosAdicionados.forEach((jogo, index) => {
                const jogoDiv = document.createElement('div');
                jogoDiv.className = 'jogo-card';
                
                jogoDiv.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <span class="font-bold text-supersete">Jogo ${index + 1}</span>
                        <div class="flex gap-2">
                            <span class="digito-badge">${jogo.digitosUnicos} √∫nicos</span>
                            <button onclick="removerJogo(${jogo.id})" class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    <div class="flex gap-1 mb-2">
                        ${jogo.numeros.map((num, colIndex) => 
                            `<div class="numero-jogo" title="Coluna ${colIndex + 1}">${num}</div>`
                        ).join('')}
                    </div>
                    <div class="text-sm text-gray-600">
                        7 colunas - ${formatarMoeda(jogo.custo)}
                    </div>
                `;
                
                lista.appendChild(jogoDiv);
            });
        }

        // Remover jogo espec√≠fico
        function removerJogo(id) {
            jogosAdicionados = jogosAdicionados.filter(jogo => jogo.id !== id);
            atualizarVisualizacaoJogos();
            atualizarCustoTotal();
        }

        // Limpar todos os jogos
        function limparTodosJogos() {
            if (jogosAdicionados.length === 0) return;
            
            // Modal customizado ao inv√©s de confirm()
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 mb-4">Tem certeza que deseja remover todos os jogos?</p>
                    <div class="flex justify-end space-x-3">
                        <button id="cancelarLimpar" class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded">Cancelar</button>
                        <button id="confirmarLimpar" class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded">Confirmar</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            document.getElementById('cancelarLimpar').onclick = () => {
                document.body.removeChild(modal);
            };
            document.getElementById('confirmarLimpar').onclick = () => {
                jogosAdicionados = [];
                atualizarVisualizacaoJogos();
                atualizarCustoTotal();
                document.body.removeChild(modal);
            };
        }

        // Atualizar custo total
        function atualizarCustoTotal() {
            const total = jogosAdicionados.length * custoJogo;
            document.getElementById('custoTotal').textContent = formatarMoeda(total);
            document.getElementById('totalJogos').textContent = jogosAdicionados.length;
        }

        // Formatar valor monet√°rio
        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }

        // Downloads
        function downloadJogos(formato) {
            if (jogosAdicionados.length === 0) {
                // Modal customizado ao inv√©s de alert()
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
                modal.innerHTML = `
                    <div class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                        <p class="text-gray-700 mb-4">Adicione pelo menos um jogo antes de fazer o download!</p>
                        <div class="flex justify-end">
                            <button class="px-4 py-2 bg-blue-500 text-white hover:bg-blue-600 rounded" onclick="this.closest('.fixed').remove()">OK</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                return;
            }
            
            switch (formato) {
                case 'html':
                    downloadHTML(jogosAdicionados);
                    break;
                case 'txt':
                    downloadTXT(jogosAdicionados);
                    break;
                case 'xlsx':
                    downloadXLSX(jogosAdicionados);
                    break;
            }
        }

        // Download HTML
        function downloadHTML(jogos) {
            const total = jogos.length * custoJogo;
            const data = new Date().toLocaleDateString('pt-BR');
            
            let html = `<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Super Sete - Meus Jogos</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { text-align: center; margin-bottom: 30px; color: #A9CF46; }
        .jogo { margin: 10px 0; padding: 15px; border: 2px solid #A9CF46; border-radius: 8px; }
        .numero { display: inline-block; width: 35px; height: 35px; background: #A9CF46; color: white; 
                 border-radius: 8px; text-align: center; line-height: 35px; margin: 2px; font-weight: bold; }
        .total { text-align: center; margin-top: 20px; font-size: 18px; font-weight: bold; color: #A9CF46; }
        .coluna { font-size: 10px; color: #666; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ SUPER SETE - MEUS JOGOS</h1>
        <p>Gerado em: ${data}</p>
    </div>`;
            
            jogos.forEach((jogo, index) => {
                html += `
    <div class="jogo">
        <h3>Jogo ${index + 1} - 7 colunas - ${formatarMoeda(jogo.custo)}</h3>
        <div>
            ${jogo.numeros.map((num, colIndex) => 
                `<span class="numero" title="Coluna ${colIndex + 1}">${num}</span>`
            ).join('')}
        </div>
        <p><small>${jogo.digitosUnicos} d√≠gitos √∫nicos</small></p>
    </div>`;
            });
            
            html += `
    <div class="total">
        Total: ${jogos.length} jogo(s) - ${formatarMoeda(total)}
    </div>
</body>
</html>`;
            
            baixarArquivo(html, 'super-sete-jogos.html', 'text/html');
        }

        // Download TXT - Somente n√∫meros
        function downloadTXT(jogos) {
            let txt = '';
            
            jogos.forEach((jogo, index) => {
                txt += jogo.numeros.join(' ');
                if (index < jogos.length - 1) {
                    txt += '\n';
                }
            });
            
            baixarArquivo(txt, 'super-sete-jogos.txt', 'text/plain');
        }

        // Download XLSX
        function downloadXLSX(jogos) {
            const dados = [
                ['Jogo', 'Col 1', 'Col 2', 'Col 3', 'Col 4', 'Col 5', 'Col 6', 'Col 7', 'D√≠gitos √önicos', 'Custo']
            ];
            
            jogos.forEach((jogo, index) => {
                dados.push([
                    `Jogo ${index + 1}`,
                    ...jogo.numeros,
                    jogo.digitosUnicos,
                    jogo.custo
                ]);
            });
            
            const total = jogos.length * custoJogo;
            dados.push(['', '', '', '', '', '', '', 'TOTAL:', jogos.length + ' jogo(s)', total]);
            
            const ws = XLSX.utils.aoa_to_sheet(dados);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Super Sete');
            XLSX.writeFile(wb, 'super-sete-jogos.xlsx');
        }

        // Fun√ß√£o auxiliar para baixar arquivo
        function baixarArquivo(conteudo, nomeArquivo, tipoMime) {
            const blob = new Blob([conteudo], { type: tipoMime });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = nomeArquivo;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>